<!doctype html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>CAMA CAMA｜住宿明細確認單</title>

<style>
:root{
  --bg:#F6F1E9;
  --card:#ffffff;
  --line:#E3D8C8;
  --title:#EDE6DA;
  --text:#3C3A36;
}

body{
  margin:0;
  background:var(--bg);
  font-family:-apple-system,BlinkMacSystemFont,"Noto Sans TC","PingFang TC","Microsoft JhengHei",sans-serif;
  color:var(--text);
}

.wrap{
  max-width:860px;
  margin:0 auto;
  padding:24px;
}

h1{
  text-align:center;
  margin-bottom:20px;
  font-size:20px;
}

.card{
  background:var(--card);
  border:1px solid var(--line);
  border-radius:18px;
  margin-bottom:20px;
  overflow:hidden;
}

.cardTitle{
  background:var(--title);
  padding:12px 16px;
  font-weight:700;
}

.cardBody{
  padding:16px;
}

.grid{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:12px;
}

.grid3{
  display:grid;
  grid-template-columns:1fr 1fr 1fr;
  gap:12px;
}

@media(max-width:720px){
  .grid,.grid3{grid-template-columns:1fr;}
}

input,textarea{
  width:100%;
  padding:10px;
  border-radius:10px;
  border:1px solid var(--line);
  box-sizing:border-box;
}

textarea{
  min-height:80px;
  resize:vertical;
}

.feeRow{
  display:grid;
  grid-template-columns:1fr 120px 120px 120px;
  gap:10px;
  margin-bottom:10px;
}

.totalBox{
  text-align:right;
  font-weight:700;
  font-size:18px;
  margin-top:10px;
}

button{
  background:#3C3A36;
  color:#fff;
  border:none;
  padding:12px 16px;
  border-radius:12px;
  cursor:pointer;
}

.linkBox{
  margin-top:15px;
  padding:10px;
  background:#fff;
  border:1px dashed var(--line);
  border-radius:10px;
  word-break:break-all;
  font-size:14px;
}
</style>
</head>

<body>
<div class="wrap">

<h1>住宿明細確認單（店家填寫）</h1>

<!-- 基本資訊 -->
<div class="card">
<div class="cardTitle">基本資訊</div>
<div class="cardBody grid">
  <input id="owner_name" placeholder="飼主姓名">
  <input id="owner_email" placeholder="飼主 Email">
  <input id="pet_name" placeholder="寵物名字">
  <input id="stay_date" placeholder="住宿日期（例：3/18-3/20）">
</div>
</div>

<div class="card">
<div class="cardTitle">活動紀錄</div>
<div class="cardBody">
  <textarea id="activity_record" placeholder="例：
第一天：食慾良好，精神穩定。
第二天：排便正常，午睡較多。
第三天：與其他狗狗互動良好。"></textarea>
</div>
</div>

<div class="card">
<div class="cardTitle">照顧細節 / 溫馨提醒</div>
<div class="cardBody">
  <textarea id="care_note" placeholder="例：回家後建議清淡飲食一天，若有軟便請觀察。"></textarea>
</div>
</div>

<div class="card">
<div class="cardTitle">費用明細</div>
<div class="cardBody">

<div id="feeContainer"></div>

<button type="button" onclick="addFeeRow()">＋新增項目</button>

<div class="totalBox">
總金額：$ <span id="total">0</span>
</div>

</div>
</div>

<button onclick="generateLink()">產生確認連結</button>

<div id="resultLink" class="linkBox" style="display:none;"></div>

</div>

<script>
let feeContainer=document.getElementById("feeContainer");

function addFeeRow(){
  const row=document.createElement("div");
  row.className="feeRow";
  row.innerHTML=`
    <input placeholder="項目">
    <input placeholder="單價" type="number" oninput="calcTotal()">
    <input placeholder="數量" type="number" value="1" oninput="calcTotal()">
    <input placeholder="小計" readonly>
  `;
  feeContainer.appendChild(row);
}

function calcTotal(){
  let rows=document.querySelectorAll(".feeRow");
  let total=0;
  rows.forEach(r=>{
    let price=r.children[1].value;
    let qty=r.children[2].value;
    let subtotal=price*qty;
    r.children[3].value=subtotal||0;
    total+=subtotal||0;
  });
  document.getElementById("total").innerText=total;
}

addFeeRow();

function generateLink(){
  let data={
    owner_name:owner_name.value,
    owner_email:owner_email.value,
    pet_name:pet_name.value,
    stay_date:stay_date.value,
    activity_record:activity_record.value,
    care_note:care_note.value,
    total:document.getElementById("total").innerText
  };

  let encoded=btoa(unescape(encodeURIComponent(JSON.stringify(data))));

  let url=`https://kumajima2025-cpu.github.io/hotel/hotel_confirm.html?data=${encoded}`;

  let box=document.getElementById("resultLink");
  box.style.display="block";
  box.innerText=url;
}
</script>

</body>
</html>
